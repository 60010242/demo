<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ร้านขายของน้องหมา </title>
<link rel="stylesheet" th:href="@{/CSS/Sfirstpage.css}">
<link href="https://fonts.googleapis.com/css2?family=Bai+Jamjuree:wght@300;400&display=swap" rel="stylesheet">
<style>
.tabcat-container {
	position: fixed;
	top: 100px;
	left: 0;
	width: 100%;
	height: 25pt;
    font-weight: bold;
  	overflow: hidden;
  	box-shadow: 2px 2px 5px gray;
	background-color: var(--browntab);
	z-index: 800;
}
.tabcat-container td{
	padding: 0;
}
.tabcat-container a{
	background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  line-height: 25pt;
  width: 80pt;
  transition: 0.3s;
  font-size: 15px;
  text-align: center;
  color: blue;
}

.tabcat-container a.active {
	color: red;
}
a.catheader{
	text-decoration: none;
	background-color: var(--brown);
	color: white;
	display: inline-block;
	width: 40pt;
	height: 40pt;
	text-align: center;
	line-height: 40pt;
}
a.cataddheader{
	color: white;
	text-decoration: none;
	vertical-align: middle;
	font-size: 20pt;
	line-height: 25pt;
	cursor: pointer;
}
a.catdelete{
	background-color: red;
	text-align: center;
	text-decoration: none;
	border-radius: 5pt;
	width: 100pt;
	height: 20pt;
	line-height: 20pt;
	color: white;
	float: right;
}
a.catdelete:hover{
	background-color: darkred;
	width: 98pt;
	height: 18pt;
	line-height: 18pt;
	font-weight: bolder;
	border: outset 1pt white;
}
.tablecat{
	margin: 0 10%;
	width: 80%;
	background-color: white;
}
.imgproduct{
	width: 60pt;
	height: 60pt;
	border-radius: 60pt;
	background-color: black;
}
.btnsubmit{
font-family: 'Bai Jamjuree', sans-serif;
	background-color: var(--green);
	height: 20pt;
	width: 50pt;
	border-radius: 5pt;
	text-align: center;
	color: white;
	border: none;
	float: right;
	cursor: pointer;
}
.btnsubmit:hover{
	background-color: darkgreen;
	width: 50pt;
	height: 20pt;
	line-height: 20pt;
	font-weight: bolder;
	border: outset 1pt white;
}
.sep>td{
	border: 4pt solid var(--brown);
	padding: 5%;
}
</style>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">

$('.tabcat-container td:first-child a').addClass("active");

function oncategory() {
	document.getElementById("overlayaddcat").style.visibility = "visible";
	console.log(window.getComputedStyle(document.getElementById('overlayaddcat')).visibility);
}
function off() {
	document.getElementById("overlayaddcat").style.visibility = "hidden";
	console.log(window.getComputedStyle(document.getElementById('overlayaddcat')).visibility);
}
function openTabCat(evt, buyerselectcat) {
	  var i, tabcats, tc;
	  
	  tabcats = document.getElementsByClassName("tabcat");
	  tc = document.getElementById(buyerselectcat);
	  
	  for (i = 0; i < tabcats.length; i++) {
	    tabcats[i].className = tabcats[i].className.replace(" active", "");
	  }
	  
	  tc.className = tc.className.replace(" active", "");
	  evt.currentTarget.className += " active";
	  console.log(tc);
	  $.ajax({url: "/editproduct/" + buyerselectcat, success: function(result){
	    	$("#div2").html(result);
	}});
}
</script>

</head>

<body>
<!-- overlay 
<div id="overlayaddcat" class="overlayaddcat center" onclick="off()">
	<div class="checked">
		<iframe th:src="@{/addcategory}"></iframe>
		<close>X</close>
	</div>
</div> -->
	
<!-- Main Page -->
<table>
	<tr class="tabcat-container">
	<td th:each="cat: ${catlist}"
		th:if="${catlist != null}">
		
		<a class="tabcat"
			th:id="|${cat.getIdCategory()}|"
			th:value="${cat.getNameCat()}"
			th:text="${cat.getNameCat()}"
			th:attr="onclick=|openTabCat(event, '${cat.getIdCategory()}')|">
		</a>
	</td>
	<td>
		<a href="/addcategory" class="cataddheader">+</a>
	</td>
	<!-- th:href="@{'/editproduct/' + ${cat.getIdCategory()}}" -->
	</tr>
</table>

<table id="div2" class="tablecat">
	<tr class="sep" th:if="${cat != null}">
		<td>
			<p>แก้ไขรายละเอียดเพิ่มเติม </p>
			
			<form action="#" th:action="@{/updatecat}"
				th:object="${cat}"
				method="post"
				enctype="multipart/form-data">
				
				<a th:href="@{'/deletecategory/' + ${cat.getIdCategory()}}"
					th:data-confirm-delete="|ต้องการลบ Category ${cat.getNameCat()}?|"
  					onclick="if (!confirm(this.getAttribute('data-confirm-delete'))) return false"
  					class="catdelete">ลบ category</a>
  				
				<input type="hidden" th:value="${cat.getIdCategory()}" th:field="*{idCategory}">
				<input type="hidden" th:value="${cat.getNameCat()}" th:field="*{nameCat}">
				<textarea th:value="${cat.getDetailCat()}" rows="10" cols="20" th:field="*{detailCat}"></textarea><br>
				
				<img style="width: 200px;" alt="can't download"
					th:src="@{'data:image/jpeg;base64,'+${cat.getPhotoCat()}}"><br>
					
				<input type="file" accept="image/*" name="imageFile"><br>
				
				<input class="btnsubmit" type="submit" value="Submit" name="button"
					th:data-confirm-submit="|ยืนยันแก้ไขรายละเอียด Category ${cat.getNameCat()}?|"
					onclick="if (!confirm(this.getAttribute('data-confirm-submit'))) return false">
			</form>
		</td>
	</tr>
	<tr class="sep" th:if="${cat != null}">
		<td>
			<div class="center">
				<a th:href="@{'/addoneproduct/' + ${cat.getIdCategory()}}">เพิ่มสินค้า </a>
			</div>
			<div th:each="product: ${products}">
				<div th:if="${product.getEnable()==1}">
					<a th:href="@{'/editoneproduct/' + ${product.getIdProduct()}}">
						<img class="imgproduct" src="">
						<!--<img class="imgproduct" style="width=100px;" th:if="${product.getPhotoProduct() == null}" alt="can't download" src="https://scontent.fbkk22-2.fna.fbcdn.net/v/t1.0-9/83968655_1508266912688925_789788986167001088_o.jpg?_nc_cat=106&_nc_sid=09cbfe&_nc_eui2=AeEmS9a7V_5EfIh3isYQehQUdnXS_5a1mcd2ddL_lrWZxwCZekQyIsKnHov1EeLDg-A_dWPuo1Ea4PKB91i3xWso&_nc_ohc=O0b9t4pD7DEAX8oKyDd&_nc_ht=scontent.fbkk22-2.fna&oh=abb0c36270eb66c217b41b3c3c035c2d&oe=5F85E625">
						<img class="imgproduct" style="width=100px;" th:if="${product.getPhotoProduct() != null}" alt="can't download" th:src="@{'data:image/jpeg;base64,'+${product.getPhotoProduct()}}"> -->
					</a>
					<a th:href="@{'/editoneproduct/' + ${product.getIdProduct()}}">
						<span th:text="${product.getNameProduct()}"></span>
					</a>
					<a th:href="@{'/editshowproduct/' + ${product.getIdProduct()} +'/' + ${cat.getIdCategory()}}">>Delete</a><br>
					<div th:if="${product.getNumberStock() == null}">
						S <span th:text="${product.getS()}"></span><br>
						M <span th:text="${product.getM()}"></span><br>
						L <span th:text="${product.getL()}"></span><br>
						XL <span th:text="${product.getXl()}"></span><br>
					</div>
					<div th:if="${product.getNumberStock() != null}">
						Stock <span th:text="${product.getNumberStock()}"></span><br>
					</div>
				</div>
			</div>
		</td>
	</tr>

</table>
</body>
</html>